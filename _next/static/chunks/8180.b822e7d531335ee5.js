"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1583,8180],{28180:(e,t,a)=>{a.r(t),a.d(t,{default:()=>w});var n=a(74848),i=a(16286),s=a(96540);let l=a(33540).Ay.div.withConfig({componentId:"sc-f808b011-0"})(["iframe{opacity:",";transition:opacity 0.25s ease-in;}.loading{&::before{color:#fff;font-weight:500;mix-blend-mode:normal;text-shadow:1px 2px 3px rgba(0,0,0,50%);}}"],({$loaded:e})=>e?"100%":"0%");var o=a(51583),r=a(8218),f=a(55650),d=a(25559),c=a(99204),p=a(45694),u=a(48060),m=a(37e3);let w=({id:e})=>{let{closeWithTransition:t,processes:{[e]:{libs:[a=""]=[],url:w=""}={}}={}}=(0,c.N)(),{createPath:g,exists:b,readFile:h,updateFolder:y,writeFile:$}=(0,d.f)(),{foregroundId:k,setForegroundId:x,setWallpaper:v}=(0,p.w)(),A=(0,s.useRef)(null),[C,E]=(0,s.useState)(!1),[_,j]=(0,s.useState)(),{prependFileToTitle:B}=(0,f.A)(e),H=(0,s.useCallback)(e=>t=>{let a=(0,i.join)(u.rO,"wallpaper.png");t.toBlob(async t=>{await $(a,await (0,m.Z6)(t),!0),v(a,e)})},[v,$]),{onDragOver:T,onDrop:D}=(0,r.A)({id:e});return(0,s.useEffect)(()=>{B("Untitled")},[B]),(0,s.useEffect)(()=>{k!==e&&A.current?.contentWindow?.addEventListener("click",()=>x(e),u.w3)},[k,e,x]),(0,s.useEffect)(()=>{let{contentWindow:a}=A.current||{};if(C&&a&&!_){let n=a.systemHooks.showOpenFileDialog,s=a.file_new;j(a),a.file_new=()=>{B("Untitled"),s()},a.systemHooks.setWallpaperTiled=H("tile"),a.systemHooks.setWallpaperCentered=H("center"),a.systemHooks.showOpenFileDialog=async e=>{let{file:t}=await n(e);return B(t.name),{file:t}},a.close=()=>t(e),a.storage_quota_exceeded=()=>{},a.systemHooks.showSaveFileDialog=async({defaultFileName:e,getBlob:t})=>y(u.Bn,await g(`${e}.png`,u.Bn,await (0,m.Z6)(await t("image/png")))),a.systemHooks.writeBlobToHandle=async(e,t)=>{await b(e)&&(await $(e,await (0,m.Z6)(t),!0),y((0,i.dirname)(e),(0,i.basename)(e)))},a.addEventListener("dragover",T),a.addEventListener("drop",D)}},[t,g,b,e,_,C,T,D,B,H,y,$]),(0,s.useEffect)(()=>{_&&w&&h(w).then(e=>{let t=_.onunhandledrejection;_.onunhandledrejection=e=>{t?.(e),e?.reason?.message==="either options.data or options.file or options.filePath must be passed"&&B("Untitled")},_.open_from_file(new File([e],w),w),B((0,i.basename)(w))})},[_,B,h,w]),(0,n.jsxs)(l,{$loaded:C,children:[!C&&(0,n.jsx)(o.default,{className:"loading"}),(0,n.jsx)("iframe",{ref:A,height:"100%",id:`jspaint-${e}`,onLoad:()=>E(!0),src:a,title:e,width:"100%",...u.aI})]})}},51583:(e,t,a)=>{a.r(t),a.d(t,{default:()=>n});let n=a(33540).Ay.div.withConfig({componentId:"sc-29e5eb62-0"})(['cursor:wait;height:100%;width:100%;&::before{color:#fff;content:"Working on it...";display:flex;font-size:12px;justify-content:center;mix-blend-mode:difference;padding-top:18px;}'])},8218:(e,t,a)=>{a.d(t,{A:()=>m});var n=a(16286),i=a(96540),s=a(51780),l=a(16091),o=a(13296),r=a(25559),f=a(99204),d=a(45694),c=a(48060),p=a(37e3),u=a(63461);let m=({callback:e,directory:t=c.Bn,id:a,onDragLeave:m,onDragOver:w,updatePositions:g})=>{let{url:b}=(0,f.N)(),h=(0,u.w)(),{iconPositions:y,sortOrders:$,setIconPositions:k}=(0,d.w)(),{exists:x,mkdirRecursive:v,updateFolder:A,writeFile:C}=(0,r.f)(),E=(0,i.useCallback)(async(e,t,i)=>{if(a){if(t){let s=(0,n.join)(c.Bn,e);if(await v(c.Bn),await C(s,t,!0))return i===o.z.UPDATE_URL&&b(a,s),A(c.Bn,e),(0,n.basename)(s)}else i===o.z.UPDATE_URL&&b(a,e)}return""},[a,v,A,b,C]),{openTransferDialog:_}=(0,s.A)();return{onDragLeave:m,onDragOver:(0,i.useCallback)(e=>{w?.(e),(0,p.CH)(e)},[w]),onDrop:(0,i.useCallback)(i=>{if(c.jj.has((0,p.uQ)(t)))return;if(g&&i.target instanceof HTMLElement){let{files:e,text:a}=(0,l.bn)(i);if(0===e.length&&""===a)return;(async()=>{let s={x:i.clientX,y:i.clientY},l=[];if(a){try{l=JSON.parse(a)}catch{}if(!Array.isArray(l))return;let[e]=l;if(!e||e.startsWith(t)&&(0,n.basename)(e)===(0,n.relative)(t,e))return;l=l.map(e=>(0,n.basename)(e))}else e instanceof FileList?l=[...e].map(e=>e.name):l=[...e].map(e=>e.getAsFile()?.name||"").filter(Boolean);l=await Promise.all(l.map(async e=>{let a=`${t}/${e}`;if(!y[a]||!await x(a))return e;let i=0;do i+=1,a=`${t}/${(0,n.basename)(e,(0,n.extname)(e))} (${i})${(0,n.extname)(e)}`;while(y[a]&&await x(a));return(0,n.basename)(a)})),(0,p.$Y)(t,i.target,y,$,s,l,k,x)})()}let s="string"==typeof a;s&&!g&&t===c.Bn&&h.current[a]?.componentWindow?.focus(c.VD),(0,l.nX)(i,e||E,t,_,s)},[e,t,x,y,a,_,h,k,$,g,E])}}},55650:(e,t,a)=>{a.d(t,{A:()=>o});var n=a(96540),i=a(99204),s=a(25573),l=a(48060);let o=e=>{let{title:t}=(0,i.N)(),[a]=e.split(l.QB),{title:o}=s.A[a]||{};return{appendFileToTitle:(0,n.useCallback)((a,n)=>{let i=a?` - ${a}${n?` ${l.g6}`:""}`:"";t(e,`${o}${i}`)},[e,o,t]),prependFileToTitle:(0,n.useCallback)((a,n,i)=>{let s=a?`${n?`${l.g6} `:""}${a}${i?" ":" - "}`:"";t(e,`${s}${o}`)},[e,o,t])}}}}]);