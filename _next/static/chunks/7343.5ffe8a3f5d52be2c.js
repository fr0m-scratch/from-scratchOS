"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1583,7343],{47343:(e,t,n)=>{n.r(t),n.d(t,{default:()=>m});var r=n(74848);let a=n(33540).Ay.div.withConfig({componentId:"sc-2afc900f-0"})(["height:",";width:100%;"],({theme:e})=>`calc(100% - ${e.sizes.titleBar.height}px)`);var i=n(96540),o=n(16602),l=n(99204),s=n(37e3),c=n(67255),d=n(48060);let u=({containerRef:e,id:t,setLoading:n,loading:r})=>{let{processes:{[t]:{libs:a=[]}={}}={}}=(0,l.N)(),u=(0,o.A)(),f=(0,c.A)(t,e,void 0,"canvas { height: calc(100% + 12px) !important; width: 100% !important; }",!0),[m,h]=(0,i.useState)();(0,i.useEffect)(()=>{if(r){let e=f?.();if(!e)return;let t=e?.document.querySelector("canvas");t.addEventListener("contextmenu",s.CH),e.Module={canvas:t,postRun:()=>{n(!1),h(e),u(e.FS,"SpaceCadet")},windowElement:e.document.body};let{height:r,width:i}=e.document.body.getBoundingClientRect()||{};r&&i&&(t.style.height=`${r}px`,t.style.width=`${i}px`,setTimeout(()=>(0,s.aY)(a,void 0,void 0,void 0,e),d.UW.WINDOW))}},[f,a,r,u,n]),(0,i.useEffect)(()=>()=>{if(m?.Module)try{m.Module.SDL2?.audioContext.close()}catch{}},[m?.Module])};var f=n(14153);let m=({id:e})=>(0,r.jsx)(f.A,{StyledComponent:a,id:e,useHook:u})},14153:(e,t,n)=>{n.d(t,{A:()=>d});var r=n(74848),a=n(96540),i=n(33540),o=n(51583),l=n(8218),s=n(99204);let c=i.Ay.div.withConfig({componentId:"sc-5da8521e-0"})([""]),d=(0,a.memo)(({id:e,useHook:t,StyledComponent:n,children:i})=>{let{processes:{[e]:{url:d=""}={}}}=(0,s.N)(),u=(0,a.useRef)(null),[f,m]=(0,a.useState)(!0),h=(0,a.useMemo)(()=>({contain:"strict",visibility:f?"hidden":"visible"}),[f]);return t({containerRef:u,id:e,loading:f,setLoading:m,url:d}),(0,r.jsxs)(r.Fragment,{children:[f&&(0,r.jsx)(o.default,{}),(0,r.jsx)(n||c,{ref:u,style:h,...(0,l.A)({id:e}),children:i})]})})},51583:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});let r=n(33540).Ay.div.withConfig({componentId:"sc-29e5eb62-0"})(['cursor:wait;height:100%;width:100%;&::before{color:#fff;content:"Working on it...";display:flex;font-size:12px;justify-content:center;mix-blend-mode:difference;padding-top:18px;}'])},16602:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(96540),a=n(25559);let i=()=>{let{mountEmscriptenFs:e,unMapFs:t,updateFolder:n}=(0,a.f)(),i=(0,r.useRef)("");return(0,r.useEffect)(()=>()=>{if(i.current){let e=i.current;i.current="",t(e,!0).then(()=>n("/",void 0,e)).catch(()=>{})}},[t,n]),(0,r.useCallback)(async(t,r)=>{if(!t)return;let a="";try{a=await e(t,r)}catch{}a&&(n("/",a),i.current=a)},[e,n])}},8218:(e,t,n)=>{n.d(t,{A:()=>h});var r=n(16286),a=n(96540),i=n(51780),o=n(16091),l=n(13296),s=n(25559),c=n(99204),d=n(45694),u=n(48060),f=n(37e3),m=n(63461);let h=({callback:e,directory:t=u.Bn,id:n,onDragLeave:h,onDragOver:y,updatePositions:p})=>{let{url:v}=(0,c.N)(),w=(0,m.w)(),{iconPositions:b,sortOrders:g,setIconPositions:E}=(0,d.w)(),{exists:A,mkdirRecursive:x,updateFolder:C,writeFile:k}=(0,s.f)(),D=(0,a.useCallback)(async(e,t,a)=>{if(n){if(t){let i=(0,r.join)(u.Bn,e);if(await x(u.Bn),await k(i,t,!0))return a===l.z.UPDATE_URL&&v(n,i),C(u.Bn,e),(0,r.basename)(i)}else a===l.z.UPDATE_URL&&v(n,e)}return""},[n,x,C,v,k]),{openTransferDialog:L}=(0,i.A)();return{onDragLeave:h,onDragOver:(0,a.useCallback)(e=>{y?.(e),(0,f.CH)(e)},[y]),onDrop:(0,a.useCallback)(a=>{if(u.jj.has((0,f.uQ)(t)))return;if(p&&a.target instanceof HTMLElement){let{files:e,text:n}=(0,o.bn)(a);if(0===e.length&&""===n)return;(async()=>{let i={x:a.clientX,y:a.clientY},o=[];if(n){try{o=JSON.parse(n)}catch{}if(!Array.isArray(o))return;let[e]=o;if(!e||e.startsWith(t)&&(0,r.basename)(e)===(0,r.relative)(t,e))return;o=o.map(e=>(0,r.basename)(e))}else e instanceof FileList?o=[...e].map(e=>e.name):o=[...e].map(e=>e.getAsFile()?.name||"").filter(Boolean);o=await Promise.all(o.map(async e=>{let n=`${t}/${e}`;if(!b[n]||!await A(n))return e;let a=0;do a+=1,n=`${t}/${(0,r.basename)(e,(0,r.extname)(e))} (${a})${(0,r.extname)(e)}`;while(b[n]&&await A(n));return(0,r.basename)(n)})),(0,f.$Y)(t,a.target,b,g,i,o,E,A)})()}let i="string"==typeof n;i&&!p&&t===u.Bn&&w.current[n]?.componentWindow?.focus(u.VD),(0,o.nX)(a,e||D,t,L,i)},[e,t,A,b,n,L,w,E,g,p,D])}}},67255:(e,t,n)=>{n.d(t,{A:()=>d});var r=n(96540),a=n(8218),i=n(48060),o=n(99204),l=n(45694);let s=e=>{let t=e.createElement("canvas");return t.id="canvas",t.style.width="100%",t.style.height="100%",t.tabIndex=-1,e.body.append(t),t},c=(e,t,n)=>{let r=document.createElement("iframe");r.title=e,r.style.backgroundColor="transparent",r.style.border="0",r.style.width="100%",r.style.height="100%",t.append(r);let a=r.contentDocument;a.open(),a.write(`
    <!DOCTYPE html>
    ${n?`<head><style>${n}</style></head>`:"<head />"}
    <body />
    `),a.close();let i=r.contentWindow;return i.document.documentElement.style.height="100%",i.document.documentElement.style.width="100%",i.document.body.style.height="100%",i.document.body.style.width="100%",i.document.body.style.margin="0",i.document.body.style.overflow="hidden",r},d=(e,t,n,d,u=!1)=>{let[f,m]=(0,r.useState)(),[h,y]=(0,r.useState)(),{onDragOver:p,onDrop:v}=(0,a.A)({id:e}),{processes:{[e]:{maximized:w}={}}={}}=(0,o.N)(),{foregroundId:b,setForegroundId:g}=(0,l.w)(),E=(0,r.useCallback)(()=>{let t;if(!f)return;f.querySelector("iframe")?.remove();let n=c(e,f,d),r=n.contentWindow;u&&(t=s(n.contentDocument));let a=()=>{u&&t?t.focus(i.VD):r.focus(),g(e)};return r.addEventListener("click",a),r.addEventListener("focus",a),r.addEventListener("blur",()=>g("")),r.addEventListener("dragover",p),r.addEventListener("drop",v),y(r),r},[f,e,p,v,g,d,u]);return(0,r.useLayoutEffect)(()=>{h&&b===e&&requestAnimationFrame(()=>{n?n(h):u?h.document.querySelector("canvas")?.focus(i.VD):h.focus()})},[h,n,b,e,w,u]),(0,r.useEffect)(()=>{if(!f){let e=()=>{requestAnimationFrame(()=>{t.current?m(t.current):e()})};e()}},[f,t]),(0,r.useMemo)(()=>f?E:void 0,[f,E])}}}]);