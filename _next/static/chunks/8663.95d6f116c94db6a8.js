"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1583,8663],{48663:(e,t,a)=>{a.r(t),a.d(t,{default:()=>B});var i=a(74848);let r=a(33540).Ay.div.withConfig({componentId:"sc-e5043948-0"})(['canvas{background-color:#000;}div{font-family:"Liberation Mono","DejaVu Sans Mono","Courier New",monospace;font-size:14px;font-weight:700;line-height:normal;position:relative;white-space:pre;}']);var n=a(16286),s=a(96540);let l={autostart:!0,bios:{url:"/Program Files/Virtual x86/bios/seabios.bin"},log_level:0,network_relay_url:"wss://relay.widgetry.org/",vga_bios:{url:"/Program Files/Virtual x86/bios/vgabios.bin"},wasm_path:"/Program Files/Virtual x86/v86.wasm"},o=".bin.save",c=new Set([160,180,200,320,360,400,720,1200,1440,1722,2880]),u=e=>c.has(e>>10)&&(1023&e)==0||512===e,h=(e,t)=>".bin"===e?"bzimage":u(t)?"fda":"hda";var d=a(85531),p=a(37e3);let f="screen-set-size-graphical",m="screen-set-size-text",g=(e,t,a)=>{let{updateWindowSize:i}=(0,d.A)(e);(0,s.useEffect)(()=>{let e=([e,a])=>{let r=t.current?.querySelector("canvas");r?.style.height&&r?.style.width?i((0,p.kl)(r?.style.height),(0,p.kl)(r?.style.width)):i(a,e)},r=([,e])=>{let{height:a,width:r}=t.current?.querySelector("span:last-of-type")?.getBoundingClientRect()||{};a&&r&&i(e*a,r)};return a?.add_listener(f,e),a?.add_listener(m,r),()=>{a?.remove_listener(f,e),a?.remove_listener(m,r)}},[a,t,i])};var w=a(55650),b=a(25559),y=a(85845),x=a(99204),v=a(45694),k=a(48060),_=a(40978),C=a(48287).Buffer;window.DEBUG=!1;let $=({containerRef:e,id:t,loading:a,setLoading:i,url:r})=>{let{processes:{[t]:c}}=(0,x.N)(),{foregroundId:u}=(0,v.w)(),{closing:d,libs:f=[]}=c||{},{appendFileToTitle:m}=(0,w.A)(t),$=(0,s.useRef)(!1),[z,B]=(0,s.useState)({}),{exists:A,readFile:E}=(0,b.f)(),M=(0,s.useCallback)(e=>new Promise((t,a)=>{z[e]?.save_state().then(t).catch(a)}),[z]),{createSnapshot:S}=(0,_.p)(),T=(0,s.useCallback)(async(e,t)=>{await S(`${(0,n.basename)(e)}${o}`,C.from(await M(e)),t);try{z[e]?.destroy()}catch{}},[S,z,M]),j=(0,s.useCallback)(async t=>{let a;if(z[t]?.v86.cpu.devices.vga.graphical_mode)a=e.current?.querySelector("canvas")?.toDataURL("image/png");else if(e.current instanceof HTMLElement){let t=await (0,p.em)();try{a=await t?.toPng(e.current,{skipAutoScale:!0})}catch{}}return a?C.from(a.replace("data:image/png;base64,",""),"base64"):void 0},[e,z]),L=(0,s.useCallback)(async()=>{let[t]=Object.keys(z);"string"==typeof t&&(await T(t,await j(t)),B({[r]:void 0}));let a=r?await E(r):C.from(""),i=(0,p.uQ)(r),s=".iso"===i,c=(0,p.Zd)(a),u={[s?"cdrom":h(i,a.length)]:{async:!1,size:a.length,url:c,use_parts:!1}},{deviceMemory:d=.25}=navigator,f={boot_order:s?531:561,memory_size:0x8000000*d,screen_container:e.current,vga_memory_size:8388608*d,...u,...l},g=(0,n.join)(k.Sb,`${(0,n.basename)(r)}${o}`),w=await A(g)?(0,p.Zd)(await E(g)):void 0;w&&(f.initial_state={url:w}),f.filesystem={basefs:URL.createObjectURL(new Blob([JSON.stringify((0,y.hf)())],{type:"application/json"})),baseurl:window.location?.origin??"/"};let b=new window.V86Starter(f);b.add_listener("emulator-loaded",()=>{if($.current){b.destroy();return}m((0,n.basename)(r)),(0,p.E)(c),f.initial_state&&(0,p.E)(f.initial_state.url),f.filesystem&&(0,p.E)(f.filesystem.basefs),e.current?.addEventListener("click",b.lock_mouse),B({[r]:b})})},[m,T,e,z,A,E,j,r]);g(t,e,z[r]),(0,s.useEffect)(()=>{a&&(0,p.aY)(f).then(()=>{window.V86Starter&&i(!1)})},[f,a,i]),(0,s.useEffect)(()=>{let e=u===t;Object.values(z).forEach(t=>t?.keyboard_set_status(e))},[z,u,t]),(0,s.useEffect)(()=>(!c||d||a||r in z||L(),()=>{if(d&&!$.current){if($.current=!0,r&&z[r]){let e=e=>{window.setTimeout(()=>T(r,e),k.UW.WINDOW)};j(r).then(e).catch(e)}else z[r]?.destroy()}}),[T,d,z,L,a,c,j,r])};var z=a(14153);let B=({id:e})=>(0,i.jsxs)(z.A,{StyledComponent:r,id:e,useHook:$,children:[(0,i.jsx)("div",{onContextMenuCapture:p.CH}),(0,i.jsx)("canvas",{onContextMenuCapture:p.CH})]})},14153:(e,t,a)=>{a.d(t,{A:()=>u});var i=a(74848),r=a(96540),n=a(33540),s=a(51583),l=a(8218),o=a(99204);let c=n.Ay.div.withConfig({componentId:"sc-5da8521e-0"})([""]),u=(0,r.memo)(({id:e,useHook:t,StyledComponent:a,children:n})=>{let{processes:{[e]:{url:u=""}={}}}=(0,o.N)(),h=(0,r.useRef)(null),[d,p]=(0,r.useState)(!0),f=(0,r.useMemo)(()=>({contain:"strict",visibility:d?"hidden":"visible"}),[d]);return t({containerRef:h,id:e,loading:d,setLoading:p,url:u}),(0,i.jsxs)(i.Fragment,{children:[d&&(0,i.jsx)(s.default,{}),(0,i.jsx)(a||c,{ref:h,style:f,...(0,l.A)({id:e}),children:n})]})})},51583:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});let i=a(33540).Ay.div.withConfig({componentId:"sc-29e5eb62-0"})(['cursor:wait;height:100%;width:100%;&::before{color:#fff;content:"Working on it...";display:flex;font-size:12px;justify-content:center;mix-blend-mode:difference;padding-top:18px;}'])},8218:(e,t,a)=>{a.d(t,{A:()=>f});var i=a(16286),r=a(96540),n=a(51780),s=a(16091),l=a(13296),o=a(25559),c=a(99204),u=a(45694),h=a(48060),d=a(37e3),p=a(63461);let f=({callback:e,directory:t=h.Bn,id:a,onDragLeave:f,onDragOver:m,updatePositions:g})=>{let{url:w}=(0,c.N)(),b=(0,p.w)(),{iconPositions:y,sortOrders:x,setIconPositions:v}=(0,u.w)(),{exists:k,mkdirRecursive:_,updateFolder:C,writeFile:$}=(0,o.f)(),z=(0,r.useCallback)(async(e,t,r)=>{if(a){if(t){let n=(0,i.join)(h.Bn,e);if(await _(h.Bn),await $(n,t,!0))return r===l.z.UPDATE_URL&&w(a,n),C(h.Bn,e),(0,i.basename)(n)}else r===l.z.UPDATE_URL&&w(a,e)}return""},[a,_,C,w,$]),{openTransferDialog:B}=(0,n.A)();return{onDragLeave:f,onDragOver:(0,r.useCallback)(e=>{m?.(e),(0,d.CH)(e)},[m]),onDrop:(0,r.useCallback)(r=>{if(h.jj.has((0,d.uQ)(t)))return;if(g&&r.target instanceof HTMLElement){let{files:e,text:a}=(0,s.bn)(r);if(0===e.length&&""===a)return;(async()=>{let n={x:r.clientX,y:r.clientY},s=[];if(a){try{s=JSON.parse(a)}catch{}if(!Array.isArray(s))return;let[e]=s;if(!e||e.startsWith(t)&&(0,i.basename)(e)===(0,i.relative)(t,e))return;s=s.map(e=>(0,i.basename)(e))}else e instanceof FileList?s=[...e].map(e=>e.name):s=[...e].map(e=>e.getAsFile()?.name||"").filter(Boolean);s=await Promise.all(s.map(async e=>{let a=`${t}/${e}`;if(!y[a]||!await k(a))return e;let r=0;do r+=1,a=`${t}/${(0,i.basename)(e,(0,i.extname)(e))} (${r})${(0,i.extname)(e)}`;while(y[a]&&await k(a));return(0,i.basename)(a)})),(0,d.$Y)(t,r.target,y,x,n,s,v,k)})()}let n="string"==typeof a;n&&!g&&t===h.Bn&&b.current[a]?.componentWindow?.focus(h.VD),(0,s.nX)(r,e||z,t,B,n)},[e,t,k,y,a,B,b,v,x,g,z])}}},79808:(e,t,a)=>{a.d(t,{Ay:()=>l,EX:()=>r,Ho:()=>i,WB:()=>n,lH:()=>s});let i={bottom:!1,bottomLeft:!1,bottomRight:!1,left:!1,right:!1,top:!1,topLeft:!1,topRight:!1},r={bottom:!0,bottomLeft:!0,bottomRight:!0,left:!0,right:!0,top:!0,topLeft:!0,topRight:!0},n=30,s=166,l={cancel:".cancel",dragHandleClassName:"handle",enableUserSelectHack:!1,minHeight:`${n}px`,minWidth:`${s}px`,resizeHandleStyles:{bottom:{bottom:"-3px",cursor:"ns-resize",height:"6px"},bottomLeft:{bottom:"-3px",cursor:"nesw-resize",height:"12px",left:"-3px",width:"12px"},bottomRight:{bottom:"-3px",cursor:"nwse-resize",height:"12px",right:"-3px",width:"12px"},left:{cursor:"ew-resize",left:"-3px",width:"6px"},right:{cursor:"ew-resize",right:"-3px",width:"6px"},top:{cursor:"ns-resize",height:"6px",top:"-3px"},topLeft:{cursor:"nwse-resize",height:"12px",left:"-3px",top:"-3px",width:"12px"},topRight:{cursor:"nesw-resize",height:"12px",right:"-3px",top:"-3px",width:"12px"}}}},36864:(e,t,a)=>{a.d(t,{Gn:()=>s,Ve:()=>c,WZ:()=>u,Xc:()=>o,r_:()=>l});var i=a(79808),r=a(48060),n=a(37e3);let s=(e,t,a=[],i=0)=>{let[s]=e.split(r.QB),l=`${s}${r.QB}`,o=a.find(e=>e.startsWith(l))||"",{componentWindow:c}=t?.[o]||{},{x:u=0,y:h=0,width:d=0,height:p=0}=c?.getBoundingClientRect()||{};return!(u+i+d>(0,n.e8)()||h+i+p>(0,n.Bv)())&&(u||h)?{x:u+i,y:h+i}:void 0},l=({height:e,width:t})=>{let[a,i]=[(0,n.Bv)(),(0,n.e8)()];return{x:Math.floor(i/2-(0,n.kl)(t)/2),y:Math.floor((a-r.D5)/2-(0,n.kl)(e)/2)}},o={BOTTOM:15,LEFT:150,RIGHT:50,TOP:15},c=(e,t,a=!1)=>{let{position:i,size:r}=e||{},{x:s=0,y:l=0}=i||{},{height:c=0,width:u=0}=r||{};return a?s+o.RIGHT>t.x||s+(0,n.kl)(u)-o.LEFT<0||l+o.BOTTOM>t.y||l+o.TOP<0:s<0||l<0||s+(0,n.kl)(u)>t.x||l+(0,n.kl)(c)>t.y},u=(e,t)=>{let a=Number(e.height),s=Number(e.width),[l,o]=[(0,n.Bv)(),(0,n.e8)()],c=l-r.D5,u=Math.max(i.WB,Math.min(a,c)),h=Math.max(i.lH,Math.min(s,o));if(!t)return{height:u,width:h};let d=a===u,p=s===h;return d||p?d?p?{height:u,width:h}:{height:Math.round(u/(s/h)),width:h}:{height:u,width:Math.round(h/(a/u))}:a>s?{height:u,width:Math.round(h/(c/u))}:{height:Math.round(u/(o/h)),width:h}}},55650:(e,t,a)=>{a.d(t,{A:()=>l});var i=a(96540),r=a(99204),n=a(25573),s=a(48060);let l=e=>{let{title:t}=(0,r.N)(),[a]=e.split(s.QB),{title:l}=n.A[a]||{};return{appendFileToTitle:(0,i.useCallback)((a,i)=>{let r=a?` - ${a}${i?` ${s.g6}`:""}`:"";t(e,`${l}${r}`)},[e,l,t]),prependFileToTitle:(0,i.useCallback)((a,i,r)=>{let n=a?`${i?`${s.g6} `:""}${a}${r?" ":" - "}`:"";t(e,`${n}${l}`)},[e,l,t])}}},85531:(e,t,a)=>{a.d(t,{A:()=>o});var i=a(33540),r=a(96540),n=a(36864),s=a(99204),l=a(45694);let o=e=>{let{setWindowStates:t}=(0,l.w)(),{processes:{[e]:{lockAspectRatio:a=!1,maximized:o=!1}={}}={}}=(0,s.N)(),{sizes:{titleBar:c}}=(0,i.DP)();return{updateWindowSize:(0,r.useCallback)((i,r)=>t(t=>({...t,[e]:{...t?.[e],maximized:o,size:(0,n.WZ)({height:i+c.height,width:r},a)}})),[e,a,o,t,c.height])}}},40978:(e,t,a)=>{a.d(t,{p:()=>l});var i=a(16286),r=a(96540),n=a(25559),s=a(48060);let l=()=>{let{createPath:e,updateFolder:t}=(0,n.f)();return{createSnapshot:(0,r.useCallback)(async(a,r,n,l=!0,o=s.Sb)=>{let c="";try{if((c=await e(a,o,r,void 0,l))&&n)try{let t="function"==typeof n?await n():n;t&&await e(`${(0,i.join)(o,c)}${s.V9}`,s.jv,t,void 0,l)}catch{}t((0,i.dirname)(o)),t(o,c)}catch{}return c},[e,t])}}}}]);