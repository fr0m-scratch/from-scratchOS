"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1583,4677],{24677:(e,t,n)=>{n.r(t),n.d(t,{default:()=>h});var a=n(74848),i=n(33540),r=n(96540),o=n(16602),s=n(99204),c=n(45694),l=n(48060),u=n(37e3),d=n(67255);let f=({containerRef:e,id:t,setLoading:n,loading:a})=>{let{processes:{[t]:f}={}}=(0,s.N)(),{componentWindow:m,defaultSize:h={height:0,width:0},libs:y=[],maximized:v=!1}=f||{},{windowStates:{[t]:b}}=(0,c.w)(),{sizes:{titleBar:w}}=(0,i.DP)(),p=(0,r.useRef)(!1),g=(0,o.A)(),{size:A}=b||{},E=(0,r.useCallback)(e=>{e?.ioq3?.canvas?e.ioq3.canvas.focus(l.VD):requestAnimationFrame(()=>E(e))},[]),k=(0,d.A)(t,e,E,`
      body { display: flex; place-content: center; place-items: center; }
      canvas { background-color: #000; height: 100%; width: 100%; }
      canvas:focus-visible { outline: none; }
    `),[q,x]=(0,r.useState)();(0,r.useEffect)(()=>{if(a){let e=k?.();e&&(0,u.aY)(y,void 0,void 0,void 0,e).then(()=>{if(!e.ioq3)return;e.ioq3.viewport=e.document.body,e.ioq3.elementPointerLock=!0,e.ioq3.callMain([]),n(!1);let t=()=>{e.ioq3?.canvas?(e.ioq3.canvas.addEventListener("contextmenu",u.CH),x(e),g(e.FS,"Quake3")):requestAnimationFrame(t)};t()})}},[k,y,a,g,n]),(0,r.useEffect)(()=>{q?.ioq3&&setTimeout(()=>{if(!q.ioq3?.canvas)return;p.current=v;let{height:e,width:t}=!v&&A||m?.getBoundingClientRect()||{};if(!e||!t)return;let n=h?(0,u.kl)(h.width)/(0,u.kl)(h.height):4/3,a=(0,u.kl)(t),i=a>(0,u.kl)(e)-w.height,r=v&&i?a/n:a,o=r/n;o>0&&r>0&&(q.ioq3.setCanvasSize(r,o),q.ioq3.canvas.setAttribute("style",`object-fit: ${i?"contain":"scale-down"}`))},v||p.current?l.UW.WINDOW+10:0)},[m,q?.ioq3,h,v,A,w.height]),(0,r.useEffect)(()=>()=>{try{q?.ioq3?.exit()}catch{}q?.AL?.contexts.forEach(({ctx:e})=>e.close())},[q?.AL?.contexts,q?.ioq3])};var m=n(14153);let h=({id:e})=>(0,a.jsx)(m.A,{id:e,useHook:f})},14153:(e,t,n)=>{n.d(t,{A:()=>u});var a=n(74848),i=n(96540),r=n(33540),o=n(51583),s=n(8218),c=n(99204);let l=r.Ay.div.withConfig({componentId:"sc-5da8521e-0"})([""]),u=(0,i.memo)(({id:e,useHook:t,StyledComponent:n,children:r})=>{let{processes:{[e]:{url:u=""}={}}}=(0,c.N)(),d=(0,i.useRef)(null),[f,m]=(0,i.useState)(!0),h=(0,i.useMemo)(()=>({contain:"strict",visibility:f?"hidden":"visible"}),[f]);return t({containerRef:d,id:e,loading:f,setLoading:m,url:u}),(0,a.jsxs)(a.Fragment,{children:[f&&(0,a.jsx)(o.default,{}),(0,a.jsx)(n||l,{ref:d,style:h,...(0,s.A)({id:e}),children:r})]})})},51583:(e,t,n)=>{n.r(t),n.d(t,{default:()=>a});let a=n(33540).Ay.div.withConfig({componentId:"sc-29e5eb62-0"})(['cursor:wait;height:100%;width:100%;&::before{color:#fff;content:"Working on it...";display:flex;font-size:12px;justify-content:center;mix-blend-mode:difference;padding-top:18px;}'])},16602:(e,t,n)=>{n.d(t,{A:()=>r});var a=n(96540),i=n(25559);let r=()=>{let{mountEmscriptenFs:e,unMapFs:t,updateFolder:n}=(0,i.f)(),r=(0,a.useRef)("");return(0,a.useEffect)(()=>()=>{if(r.current){let e=r.current;r.current="",t(e,!0).then(()=>n("/",void 0,e)).catch(()=>{})}},[t,n]),(0,a.useCallback)(async(t,a)=>{if(!t)return;let i="";try{i=await e(t,a)}catch{}i&&(n("/",i),r.current=i)},[e,n])}},8218:(e,t,n)=>{n.d(t,{A:()=>h});var a=n(16286),i=n(96540),r=n(51780),o=n(16091),s=n(13296),c=n(25559),l=n(99204),u=n(45694),d=n(48060),f=n(37e3),m=n(63461);let h=({callback:e,directory:t=d.Bn,id:n,onDragLeave:h,onDragOver:y,updatePositions:v})=>{let{url:b}=(0,l.N)(),w=(0,m.w)(),{iconPositions:p,sortOrders:g,setIconPositions:A}=(0,u.w)(),{exists:E,mkdirRecursive:k,updateFolder:q,writeFile:x}=(0,c.f)(),C=(0,i.useCallback)(async(e,t,i)=>{if(n){if(t){let r=(0,a.join)(d.Bn,e);if(await k(d.Bn),await x(r,t,!0))return i===s.z.UPDATE_URL&&b(n,r),q(d.Bn,e),(0,a.basename)(r)}else i===s.z.UPDATE_URL&&b(n,e)}return""},[n,k,q,b,x]),{openTransferDialog:L}=(0,r.A)();return{onDragLeave:h,onDragOver:(0,i.useCallback)(e=>{y?.(e),(0,f.CH)(e)},[y]),onDrop:(0,i.useCallback)(i=>{if(d.jj.has((0,f.uQ)(t)))return;if(v&&i.target instanceof HTMLElement){let{files:e,text:n}=(0,o.bn)(i);if(0===e.length&&""===n)return;(async()=>{let r={x:i.clientX,y:i.clientY},o=[];if(n){try{o=JSON.parse(n)}catch{}if(!Array.isArray(o))return;let[e]=o;if(!e||e.startsWith(t)&&(0,a.basename)(e)===(0,a.relative)(t,e))return;o=o.map(e=>(0,a.basename)(e))}else e instanceof FileList?o=[...e].map(e=>e.name):o=[...e].map(e=>e.getAsFile()?.name||"").filter(Boolean);o=await Promise.all(o.map(async e=>{let n=`${t}/${e}`;if(!p[n]||!await E(n))return e;let i=0;do i+=1,n=`${t}/${(0,a.basename)(e,(0,a.extname)(e))} (${i})${(0,a.extname)(e)}`;while(p[n]&&await E(n));return(0,a.basename)(n)})),(0,f.$Y)(t,i.target,p,g,r,o,A,E)})()}let r="string"==typeof n;r&&!v&&t===d.Bn&&w.current[n]?.componentWindow?.focus(d.VD),(0,o.nX)(i,e||C,t,L,r)},[e,t,E,p,n,L,w,A,g,v,C])}}},67255:(e,t,n)=>{n.d(t,{A:()=>u});var a=n(96540),i=n(8218),r=n(48060),o=n(99204),s=n(45694);let c=e=>{let t=e.createElement("canvas");return t.id="canvas",t.style.width="100%",t.style.height="100%",t.tabIndex=-1,e.body.append(t),t},l=(e,t,n)=>{let a=document.createElement("iframe");a.title=e,a.style.backgroundColor="transparent",a.style.border="0",a.style.width="100%",a.style.height="100%",t.append(a);let i=a.contentDocument;i.open(),i.write(`
    <!DOCTYPE html>
    ${n?`<head><style>${n}</style></head>`:"<head />"}
    <body />
    `),i.close();let r=a.contentWindow;return r.document.documentElement.style.height="100%",r.document.documentElement.style.width="100%",r.document.body.style.height="100%",r.document.body.style.width="100%",r.document.body.style.margin="0",r.document.body.style.overflow="hidden",a},u=(e,t,n,u,d=!1)=>{let[f,m]=(0,a.useState)(),[h,y]=(0,a.useState)(),{onDragOver:v,onDrop:b}=(0,i.A)({id:e}),{processes:{[e]:{maximized:w}={}}={}}=(0,o.N)(),{foregroundId:p,setForegroundId:g}=(0,s.w)(),A=(0,a.useCallback)(()=>{let t;if(!f)return;f.querySelector("iframe")?.remove();let n=l(e,f,u),a=n.contentWindow;d&&(t=c(n.contentDocument));let i=()=>{d&&t?t.focus(r.VD):a.focus(),g(e)};return a.addEventListener("click",i),a.addEventListener("focus",i),a.addEventListener("blur",()=>g("")),a.addEventListener("dragover",v),a.addEventListener("drop",b),y(a),a},[f,e,v,b,g,u,d]);return(0,a.useLayoutEffect)(()=>{h&&p===e&&requestAnimationFrame(()=>{n?n(h):d?h.document.querySelector("canvas")?.focus(r.VD):h.focus()})},[h,n,p,e,w,d]),(0,a.useEffect)(()=>{if(!f){let e=()=>{requestAnimationFrame(()=>{t.current?m(t.current):e()})};e()}},[f,t]),(0,a.useMemo)(()=>f?A:void 0,[f,A])}}}]);